{% extends "delivery_app/base.html" %}
{% load static %}

{% block title %}
–°–ª–æ–≤–∞—Ä—å —Ç–µ—Ä–º–∏–Ω–æ–≤
{% endblock %}

{% block content %}
<div class="faq-container">
    <div class="page-header">
        <h1>–°–ª–æ–≤–∞—Ä—å —Ç–µ—Ä–º–∏–Ω–æ–≤</h1>
        <p class="page-subtitle">–í—Å–µ, —á—Ç–æ –≤–∞–º –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å –æ –Ω–∞—à–µ–π —Å–ª—É–∂–±–µ –¥–æ—Å—Ç–∞–≤–∫–∏</p>
        <p class="current-date">–î–∞—Ç–∞: {{ current_date }} | –í—Ä–µ–º–µ–Ω–Ω–∞—è –∑–æ–Ω–∞: {{ timezone }}</p>
    </div>

    {% if faqs %}
    <div class="search-section">
        <div class="search-box">
            <input type="text" id="faq-search" placeholder="–ü–æ–∏—Å–∫ –ø–æ —Ç–µ—Ä–º–∏–Ω–∞–º..." class="search-input">
            <span class="search-icon">üîç</span>
        </div>
        <p class="search-help">–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å —Å–ª–æ–≤–æ –∏–ª–∏ —Ñ—Ä–∞–∑—É –¥–ª—è –ø–æ–∏—Å–∫–∞ –≤ –≤–æ–ø—Ä–æ—Å–∞—Ö –∏ –æ—Ç–≤–µ—Ç–∞—Ö</p>
    </div>

    <div class="faq-list" id="faq-list">
        {% for faq in faqs %}
        <div class="faq-item" data-faq-id="{{ faq.id }}">
            <div class="faq-question" onclick="toggleFaq({{ faq.id }})">
                <h3>{{ faq.question }}</h3>
                <span class="faq-toggle">+</span>
            </div>
            <div class="faq-answer">
                <div class="faq-content">
                    {{ faq.answer|linebreaks }}
                    <div class="faq-meta">
                        <span class="faq-date">–î–æ–±–∞–≤–ª–µ–Ω–æ: {{ faq.added_date|date:'d.m.Y' }}</span>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <div class="faq-stats">
        <p>–í—Å–µ–≥–æ —Ç–µ—Ä–º–∏–Ω–æ–≤: {{ faqs|length }}</p>
    </div>
    {% else %}
    <div class="no-faqs">
        <div class="empty-state">
            <img src="{% static 'delivery_app/images/empty-faq.svg' %}" alt="–ù–µ—Ç –≤–æ–ø—Ä–æ—Å–æ–≤" class="empty-image">
            <h3>–†–∞–∑–¥–µ–ª —Å–ª–æ–≤–∞—Ä—è —Ç–µ—Ä–º–∏–Ω–æ–≤ –ø—É—Å—Ç</h3>
            <p>–ú—ã —Å–∫–æ—Ä–æ –¥–æ–±–∞–≤–∏–º –ø–æ–ª–µ–∑–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–∞—à–µ–π —Å–ª—É–∂–±–µ –¥–æ—Å—Ç–∞–≤–∫–∏.</p>
        </div>
    </div>
    {% endif %}

    <div class="contact-support">
        <h2>–ù–µ –Ω–∞—à–ª–∏ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å?</h2>
        <p>–°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞—à–µ–π —Å–ª—É–∂–±–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏, –∏ –º—ã —Å —Ä–∞–¥–æ—Å—Ç—å—é –ø–æ–º–æ–∂–µ–º –≤–∞–º!</p>
        <div class="contact-options">
            <a href="tel:+375171234567" class="contact-btn">
                <span class="contact-icon">üìû</span>
                –ü–æ–∑–≤–æ–Ω–∏—Ç—å –Ω–∞–º
            </a>
            <a href="mailto:support@product-delivery.by" class="contact-btn">
                <span class="contact-icon">‚úâÔ∏è</span>
                –ù–∞–ø–∏—Å–∞—Ç—å –Ω–∞–º
            </a>
        </div>
    </div>
</div>

<style>
.faq-container {
    max-width: 900px;
    margin: 0 auto;
    padding: 20px;
}

.page-header {
    text-align: center;
    margin-bottom: 40px;
    padding: 20px;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    border-radius: 10px;
}

.page-header h1 {
    color: #2c5aa0;
    margin-bottom: 10px;
}

.page-subtitle {
    font-size: 1.2em;
    color: #6c757d;
    margin-bottom: 15px;
}

.current-date {
    font-size: 0.9em;
    color: #6c757d;
}

.search-section {
    margin-bottom: 30px;
}

.search-box {
    position: relative;
    max-width: 500px;
    margin: 0 auto 10px;
}

.search-input {
    width: 100%;
    padding: 12px 45px 12px 15px;
    border: 2px solid #e9ecef;
    border-radius: 25px;
    font-size: 1em;
    transition: border-color 0.3s ease;
}

.search-input:focus {
    outline: none;
    border-color: #2c5aa0;
}

.search-icon {
    position: absolute;
    right: 15px;
    top: 50%;
    transform: translateY(-50%);
    color: #6c757d;
}

.search-help {
    text-align: center;
    color: #6c757d;
    font-size: 0.9em;
}

.faq-list {
    margin-bottom: 30px;
}

.faq-item {
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    margin-bottom: 15px;
    overflow: hidden;
    transition: box-shadow 0.3s ease;
}

.faq-item:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.faq-question {
    padding: 20px;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: #f8f9fa;
    transition: background-color 0.3s ease;
}

.faq-question:hover {
    background-color: #e9ecef;
}

.faq-question h3 {
    margin: 0;
    color: #2c5aa0;
    font-size: 1.1em;
    flex: 1;
}

.faq-toggle {
    font-size: 1.5em;
    font-weight: bold;
    color: #2c5aa0;
    transition: transform 0.3s ease;
}

.faq-answer {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.5s ease;
}

.faq-item.active .faq-answer {
    max-height: 500px;
}

.faq-item.active .faq-toggle {
    transform: rotate(45deg);
}

.faq-content {
    padding: 20px;
    line-height: 1.6;
}

.faq-meta {
    margin-top: 15px;
    padding-top: 15px;
    border-top: 1px solid #e9ecef;
}

.faq-date {
    font-size: 0.9em;
    color: #6c757d;
}

.faq-stats {
    text-align: center;
    color: #6c757d;
    margin-bottom: 30px;
}

.no-faqs {
    text-align: center;
    padding: 40px 0;
}

.empty-state {
    max-width: 500px;
    margin: 0 auto;
}

.empty-image {
    max-width: 200px;
    margin-bottom: 20px;
}

.contact-support {
    background-color: #f8f9fa;
    padding: 30px;
    border-radius: 10px;
    text-align: center;
    margin-top: 30px;
}

.contact-support h2 {
    color: #2c5aa0;
    margin-bottom: 15px;
}

.contact-options {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-top: 20px;
    flex-wrap: wrap;
}

.contact-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 12px 20px;
    background-color: #7eaff7;
    color: white;
    text-decoration: none;
    border-radius: 25px;
    transition: background-color 0.3s ease;
}

.contact-btn:hover {
    background-color: #1e3d6f;
    color: white;
    text-decoration: none;
}

.contact-icon {
    font-size: 1.2em;
}

/* –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ */
.highlight {
    background-color: #fff3cd;
    padding: 2px 4px;
    border-radius: 3px;
}

@media (max-width: 768px) {
    .faq-container {
        padding: 15px;
    }
    
    .faq-question {
        padding: 15px;
    }
    
    .faq-content {
        padding: 15px;
    }
    
    .contact-options {
        flex-direction: column;
        align-items: center;
    }
    
    .contact-btn {
        width: 100%;
        max-width: 250px;
        justify-content: center;
    }
}
</style>

<script>
// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞
function toggleFaq(faqId) {
    const faqItem = document.querySelector(`.faq-item[data-faq-id="${faqId}"]`);
    faqItem.classList.toggle('active');
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ FAQ
document.getElementById('faq-search').addEventListener('input', function(e) {
    const searchTerm = e.target.value.toLowerCase();
    const faqItems = document.querySelectorAll('.faq-item');
    
    faqItems.forEach(item => {
        const question = item.querySelector('.faq-question h3').textContent.toLowerCase();
        const answer = item.querySelector('.faq-content').textContent.toLowerCase();
        
        if (question.includes(searchTerm) || answer.includes(searchTerm)) {
            item.style.display = 'block';
            
            // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
            if (searchTerm.length > 2) {
                const regex = new RegExp(searchTerm, 'gi');
                const questionElem = item.querySelector('.faq-question h3');
                const answerElem = item.querySelector('.faq-content');
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç
                if (!questionElem.dataset.original) {
                    questionElem.dataset.original = questionElem.innerHTML;
                }
                if (!answerElem.dataset.original) {
                    answerElem.dataset.original = answerElem.innerHTML;
                }
                
                // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
                questionElem.innerHTML = questionElem.dataset.original.replace(
                    regex, 
                    match => `<span class="highlight">${match}</span>`
                );
                
                answerElem.innerHTML = answerElem.dataset.original.replace(
                    regex, 
                    match => `<span class="highlight">${match}</span>`
                );
            }
        } else {
            item.style.display = 'none';
        }
    });
});

// –û—Ç–∫—Ä—ã–≤–∞–µ–º FAQ –ø–æ —è–∫–æ—Ä–Ω–æ–π —Å—Å—ã–ª–∫–µ
document.addEventListener('DOMContentLoaded', function() {
    const hash = window.location.hash;
    if (hash) {
        const faqId = hash.replace('#faq-', '');
        const faqItem = document.querySelector(`.faq-item[data-faq-id="${faqId}"]`);
        if (faqItem) {
            faqItem.classList.add('active');
            faqItem.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    }
    
    // –î–µ–ª–∞–µ–º –ø–µ—Ä–≤—ã–π FAQ –∞–∫—Ç–∏–≤–Ω—ã–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    const firstFaq = document.querySelector('.faq-item');
    if (firstFaq) {
        firstFaq.classList.add('active');
    }
});
</script>
{% endblock %}