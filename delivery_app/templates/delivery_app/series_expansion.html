{% extends "delivery_app/base.html" %}
{% load static %}

{% block title %}
–†–∞–∑–ª–æ–∂–µ–Ω–∏–µ –≤ —Ä—è–¥ - –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
{% endblock %}

{% block meta_description %}
–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ eÀ£ –≤ —Ä—è–¥ –¢–µ–π–ª–æ—Ä–∞. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏—è —Ä—è–¥–∞ —Å —Ç–æ—á–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏.
{% endblock %}

{% block content %}
<div class="math-visualization-container">
    <div class="page-header">
        <h1>–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</h1>
        <p class="page-subtitle">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ eÀ£ –≤ —Ä—è–¥ –¢–µ–π–ª–æ—Ä–∞</p>
    </div>

    <div class="math-content">
        <div class="formula-display">
            <div class="formula-card">
                <h3>–†—è–¥ –¢–µ–π–ª–æ—Ä–∞ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ eÀ£</h3>
                <div class="formula">
                    \[e^x = \sum_{n=0}^\infty \frac{x^n}{n!} = 1 + x + \frac{x^2}{2} + \frac{x^3}{6} + \frac{x^4}{24} + \cdots\]
                </div>
                <p class="formula-description">
                    –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è eÀ£ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –≤ –≤–∏–¥–µ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–≥–æ —Ä—è–¥–∞ –¢–µ–π–ª–æ—Ä–∞. 
                    –ß–µ–º –±–æ–ª—å—à–µ —á–ª–µ–Ω–æ–≤ —Ä—è–¥–∞ –º—ã —É—á–∏—Ç—ã–≤–∞–µ–º, —Ç–µ–º —Ç–æ—á–Ω–µ–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ –∫ —Ä–µ–∞–ª—å–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é —Ñ—É–Ω–∫—Ü–∏–∏.
                </p>
            </div>
        </div>

        <div class="visualization-section">
            <div class="controls-panel">
                <div class="control-group">
                    <label for="nRange">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–ª–µ–Ω–æ–≤ —Ä—è–¥–∞ (n):</label>
                    <input type="range" id="nRange" min="0" max="10" value="0" step="1">
                    <div class="value-display" id="nValue">n = 0</div>
                </div>
                
                <div class="control-group">
                    <label for="xRange">–î–∏–∞–ø–∞–∑–æ–Ω x:</label>
                    <input type="range" id="xRange" min="1" max="5" value="3" step="0.1">
                    <div class="value-display" id="xValue">[-3, 3]</div>
                </div>
                
                <div class="control-group">
                    <label for="animationSpeed">–°–∫–æ—Ä–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏:</label>
                    <input type="range" id="animationSpeed" min="1" max="10" value="5" step="1">
                    <div class="value-display" id="speedValue">–°—Ä–µ–¥–Ω—è—è</div>
                </div>
            </div>

            <div class="action-buttons">
                <button id="startAnimation" class="btn btn-primary">
                    <span class="btn-icon">‚ñ∂Ô∏è</span> –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é
                </button>
                <button id="pauseAnimation" class="btn btn-secondary" disabled>
                    <span class="btn-icon">‚è∏Ô∏è</span> –ü–∞—É–∑–∞
                </button>
                <button id="resetAnimation" class="btn btn-outline">
                    <span class="btn-icon">üîÑ</span> –°–±—Ä–æ—Å–∏—Ç—å
                </button>
                <button id="exportChart" class="btn btn-success">
                    <span class="btn-icon">üíæ</span> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫
                </button>
            </div>

            <div class="chart-container">
                <canvas id="seriesChart"></canvas>
            </div>

            <div class="info-grid">
                <div class="info-card">
                    <div class="info-icon">üìà</div>
                    <h4>–†—è–¥ –¢–µ–π–ª–æ—Ä–∞</h4>
                    <p>–ü—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é –∫–æ–Ω–µ—á–Ω–æ–π —Å—É–º–º—ã —á–ª–µ–Ω–æ–≤ —Ä—è–¥–∞. –¢–æ—á–Ω–æ—Å—Ç—å –≤–æ–∑—Ä–∞—Å—Ç–∞–µ—Ç —Å —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º n.</p>
                </div>
                <div class="info-card">
                    <div class="info-icon">üéØ</div>
                    <h4>–¢–æ—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ</h4>
                    <p>–í—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é Math.exp(x) –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º —Ä—è–¥–∞.</p>
                </div>
                <div class="info-card">
                    <div class="info-icon">üìä</div>
                    <h4>–ü–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å</h4>
                    <p>–†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω—ã–º –∏ —Ç–æ—á–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏—è.</p>
                </div>
            </div>
        </div>

        <div class="explanation-section">
            <h2>–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞</h2>
            <div class="explanation-content">
                <p>
                    <strong>–†—è–¥ –¢–µ–π–ª–æ—Ä–∞</strong> –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –≤ –≤–∏–¥–µ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–π —Å—É–º–º—ã, 
                    –≤—ã—á–∏—Å–ª–µ–Ω–Ω–æ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Ç–æ—á–∫–µ (–≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –≤ —Ç–æ—á–∫–µ 0).
                </p>
                
                <div class="step-explanation">
                    <h4>–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:</h4>
                    <ul>
                        <li>–ü—Ä–∏ n=0: —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π —á–ª–µ–Ω —Ä—è–¥–∞: eÀ£ ‚âà 1</li>
                        <li>–ü—Ä–∏ n=1: eÀ£ ‚âà 1 + x</li>
                        <li>–ü—Ä–∏ n=2: eÀ£ ‚âà 1 + x + x¬≤/2</li>
                        <li>–ü—Ä–∏ n=3: eÀ£ ‚âà 1 + x + x¬≤/2 + x¬≥/6</li>
                        <li>–ò —Ç–∞–∫ –¥–∞–ª–µ–µ...</li>
                    </ul>
                </div>

                <p>
                    –° –∫–∞–∂–¥—ã–º –Ω–æ–≤—ã–º —á–ª–µ–Ω–æ–º —Ä—è–¥–∞ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ç–æ—á–Ω–µ–µ, –æ—Å–æ–±–µ–Ω–Ω–æ –≤–±–ª–∏–∑–∏ —Ç–æ—á–∫–∏ x=0.
                    –ü—Ä–∏ n ‚Üí ‚àû —Ä—è–¥ —Å—Ö–æ–¥–∏—Ç—Å—è –∫ —Ç–æ—á–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é —Ñ—É–Ω–∫—Ü–∏–∏ eÀ£ –¥–ª—è –≤—Å–µ—Ö x.
                </p>
            </div>
        </div>
    </div>
</div>

<style>
.math-visualization-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

.page-header {
    text-align: center;
    margin-bottom: 40px;
    padding: 30px;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    border-radius: 15px;
}

.page-header h1 {
    color: #2c5aa0;
    margin-bottom: 10px;
    font-size: 2.5em;
}

.page-subtitle {
    color: #6c757d;
    font-size: 1.2em;
    margin-bottom: 0;
}

.math-content {
    background: white;
    border-radius: 15px;
    padding: 0;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
}

.formula-display {
    padding: 30px;
    border-bottom: 1px solid #e9ecef;
}

.formula-card {
    text-align: center;
    max-width: 800px;
    margin: 0 auto;
}

.formula-card h3 {
    color: #2c5aa0;
    margin-bottom: 20px;
}

.formula {
    font-size: 1.3em;
    margin: 25px 0;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 10px;
    border-left: 4px solid #2c5aa0;
}

.formula-description {
    color: #6c757d;
    line-height: 1.6;
    font-size: 1.1em;
}

.visualization-section {
    padding: 30px;
}

.controls-panel {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 25px;
    margin-bottom: 30px;
    padding: 25px;
    background: #f8f9fa;
    border-radius: 10px;
}

.control-group {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.control-group label {
    font-weight: bold;
    color: #2c5aa0;
    font-size: 0.95em;
}

.control-group input[type="range"] {
    width: 100%;
    height: 6px;
    border-radius: 3px;
    background: #dee2e6;
    outline: none;
}

.value-display {
    text-align: center;
    font-weight: bold;
    color: #2c5aa0;
    background: white;
    padding: 8px 12px;
    border-radius: 6px;
    border: 1px solid #e9ecef;
}

.action-buttons {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 12px;
    margin: 25px 0;
}

.btn {
    padding: 12px 20px;
    border: none;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    font-size: 0.95em;
}

.btn-primary {
    background: #2c5aa0;
    color: white;
}

.btn-secondary {
    background: #6c757d;
    color: white;
}

.btn-success {
    background: #28a745;
    color: white;
}

.btn-outline {
    background: transparent;
    color: #2c5aa0;
    border: 2px solid #2c5aa0;
}

.btn:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none;
}

.btn-icon {
    font-size: 1.1em;
}

.chart-container {
    position: relative;
    height: 500px;
    margin: 30px 0;
    background: white;
    border-radius: 10px;
    border: 1px solid #e9ecef;
    padding: 20px;
}

.info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin: 30px 0;
}

.info-card {
    text-align: center;
    padding: 25px 20px;
    background: #f8f9fa;
    border-radius: 10px;
    border-left: 4px solid #2c5aa0;
    transition: transform 0.3s ease;
}

.info-card:hover {
    transform: translateY(-5px);
}

.info-icon {
    font-size: 2.5em;
    margin-bottom: 15px;
}

.info-card h4 {
    color: #2c5aa0;
    margin-bottom: 10px;
}

.info-card p {
    color: #6c757d;
    line-height: 1.5;
    font-size: 0.95em;
}

.explanation-section {
    padding: 30px;
    border-top: 1px solid #e9ecef;
    background: #f8f9fa;
    border-radius: 0 0 15px 15px;
}

.explanation-section h2 {
    color: #2c5aa0;
    text-align: center;
    margin-bottom: 25px;
}

.explanation-content {
    max-width: 800px;
    margin: 0 auto;
    line-height: 1.7;
}

.explanation-content p {
    margin-bottom: 20px;
    color: #495057;
}

.step-explanation {
    background: white;
    padding: 20px;
    border-radius: 8px;
    margin: 20px 0;
    border-left: 4px solid #28a745;
}

.step-explanation h4 {
    color: #28a745;
    margin-bottom: 15px;
}

.step-explanation ul {
    color: #495057;
    padding-left: 20px;
}

.step-explanation li {
    margin-bottom: 8px;
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
@media (max-width: 768px) {
    .math-visualization-container {
        padding: 15px;
    }
    
    .page-header {
        padding: 20px;
    }
    
    .page-header h1 {
        font-size: 2em;
    }
    
    .chart-container {
        height: 400px;
        padding: 15px;
    }
    
    .controls-panel {
        grid-template-columns: 1fr;
        gap: 20px;
    }
    
    .action-buttons {
        grid-template-columns: 1fr;
    }
    
    .info-grid {
        grid-template-columns: 1fr;
    }
    
    .formula {
        font-size: 1.1em;
        padding: 15px;
    }
}

@media (max-width: 480px) {
    .chart-container {
        height: 350px;
    }
    
    .visualization-section {
        padding: 20px;
    }
    
    .explanation-section {
        padding: 20px;
    }
}
</style>

<!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjs@11.8.0/lib/browser/math.js"></script>

<script>
// –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
let seriesChart;
let currentN = 0;
let animationInterval;
let isAnimating = false;

// –≠–ª–µ–º–µ–Ω—Ç—ã DOM
const nRange = document.getElementById('nRange');
const nValue = document.getElementById('nValue');
const xRange = document.getElementById('xRange');
const xValue = document.getElementById('xValue');
const animationSpeed = document.getElementById('animationSpeed');
const speedValue = document.getElementById('speedValue');
const startButton = document.getElementById('startAnimation');
const pauseButton = document.getElementById('pauseAnimation');
const resetButton = document.getElementById('resetAnimation');
const exportButton = document.getElementById('exportChart');

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Ä—è–¥–∞ –¢–µ–π–ª–æ—Ä–∞ –¥–ª—è e^x
function taylorSeriesExp(x, n) {
    if (n < 0) return 0;
    
    let sum = 0;
    let term = 1; // –ø–µ—Ä–≤—ã–π —á–ª–µ–Ω: x^0/0! = 1
    
    for (let i = 0; i <= n; i++) {
        if (i > 0) {
            term *= x / i;
        }
        sum += term;
    }
    
    return sum;
}

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞
function generateData(n, xRangeValue) {
    const xMin = -xRangeValue;
    const xMax = xRangeValue;
    const step = (xMax - xMin) / 100;
    
    const labels = [];
    const seriesData = [];
    const exactData = [];
    const errorData = [];
    
    for (let x = xMin; x <= xMax; x += step) {
        const xFixed = parseFloat(x.toFixed(2));
        labels.push(xFixed);
        
        const seriesValue = taylorSeriesExp(x, n);
        const exactValue = Math.exp(x);
        
        seriesData.push(seriesValue);
        exactData.push(exactValue);
        errorData.push(Math.abs(seriesValue - exactValue));
    }
    
    return { labels, seriesData, exactData, errorData };
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–∞
function initChart() {
    const ctx = document.getElementById('seriesChart').getContext('2d');
    const data = generateData(currentN, parseFloat(xRange.value));
    
    // –£–Ω–∏—á—Ç–æ–∂–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –≥—Ä–∞—Ñ–∏–∫, –µ—Å–ª–∏ –æ–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
    if (seriesChart) {
        seriesChart.destroy();
    }
    
    seriesChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: data.labels,
            datasets: [
                {
                    label: `–†—è–¥ –¢–µ–π–ª–æ—Ä–∞ (n=${currentN})`,
                    data: data.seriesData,
                    borderColor: '#2c5aa0',
                    backgroundColor: 'rgba(44, 90, 160, 0.1)',
                    borderWidth: 3,
                    tension: 0.1,
                    pointRadius: 0
                },
                {
                    label: '–¢–æ—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ eÀ£',
                    data: data.exactData,
                    borderColor: '#28a745',
                    backgroundColor: 'rgba(40, 167, 69, 0.1)',
                    borderWidth: 2,
                    borderDash: [5, 5],
                    tension: 0.1,
                    pointRadius: 0
                },
                {
                    label: '–ü–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å',
                    data: data.errorData,
                    borderColor: '#dc3545',
                    backgroundColor: 'rgba(220, 53, 69, 0.1)',
                    borderWidth: 1,
                    tension: 0.1,
                    pointRadius: 0,
                    yAxisID: 'y1'
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            animation: {
                duration: 500
            },
            plugins: {
                title: {
                    display: true,
                    text: '–†–∞–∑–ª–æ–∂–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ eÀ£ –≤ —Ä—è–¥ –¢–µ–π–ª–æ—Ä–∞',
                    font: {
                        size: 16
                    }
                },
                legend: {
                    display: true,
                    position: 'top'
                },
                tooltip: {
                    mode: 'index',
                    intersect: false
                }
            },
            scales: {
                x: {
                    title: {
                        display: true,
                        text: 'x'
                    },
                    grid: {
                        color: 'rgba(0, 0, 0, 0.1)'
                    }
                },
                y: {
                    title: {
                        display: true,
                        text: 'f(x)'
                    },
                    grid: {
                        color: 'rgba(0, 0, 0, 0.1)'
                    }
                },
                y1: {
                    position: 'right',
                    title: {
                        display: true,
                        text: '–ü–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å'
                    },
                    grid: {
                        drawOnChartArea: false
                    }
                }
            }
        }
    });
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
function updateChart() {
    if (!seriesChart) return;
    
    const data = generateData(currentN, parseFloat(xRange.value));
    
    seriesChart.data.labels = data.labels;
    seriesChart.data.datasets[0].data = data.seriesData;
    seriesChart.data.datasets[0].label = `–†—è–¥ –¢–µ–π–ª–æ—Ä–∞ (n=${currentN})`;
    seriesChart.data.datasets[1].data = data.exactData;
    seriesChart.data.datasets[2].data = data.errorData;
    
    seriesChart.update('none');
}

// –§—É–Ω–∫—Ü–∏–∏ –∞–Ω–∏–º–∞—Ü–∏–∏
function startAnimation() {
    if (isAnimating) return;
    
    isAnimating = true;
    startButton.disabled = true;
    pauseButton.disabled = false;
    
    const maxN = parseInt(nRange.max);
    const speed = 1100 - (parseInt(animationSpeed.value) * 100);
    
    animationInterval = setInterval(() => {
        if (currentN < maxN) {
            currentN++;
            nRange.value = currentN;
            nValue.textContent = `n = ${currentN}`;
            updateChart();
        } else {
            pauseAnimation();
        }
    }, speed);
}

function pauseAnimation() {
    isAnimating = false;
    clearInterval(animationInterval);
    startButton.disabled = false;
    pauseButton.disabled = true;
}

function resetAnimation() {
    pauseAnimation();
    currentN = 0;
    nRange.value = currentN;
    nValue.textContent = `n = ${currentN}`;
    updateChart();
}

// –≠–∫—Å–ø–æ—Ä—Ç –≥—Ä–∞—Ñ–∏–∫–∞
function exportChart() {
    if (!seriesChart) return;
    
    const link = document.createElement('a');
    link.download = `e^x_series_n${currentN}.png`;
    link.href = seriesChart.toBase64Image();
    link.click();
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
document.addEventListener('DOMContentLoaded', function() {
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    nRange.addEventListener('input', function() {
        currentN = parseInt(this.value);
        nValue.textContent = `n = ${currentN}`;
        updateChart();
    });

    xRange.addEventListener('input', function() {
        const value = parseFloat(this.value);
        xValue.textContent = `[-${value.toFixed(1)}, ${value.toFixed(1)}]`;
        updateChart();
    });

    animationSpeed.addEventListener('input', function() {
        const value = parseInt(this.value);
        const speeds = ['–û—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ', '–ú–µ–¥–ª–µ–Ω–Ω–æ', '–£–º–µ—Ä–µ–Ω–Ω–æ', '–°—Ä–µ–¥–Ω—è—è', '–ë—ã—Å—Ç—Ä–æ', '–û—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ'];
        speedValue.textContent = speeds[value - 1] || '–°—Ä–µ–¥–Ω—è—è';
        
        if (isAnimating) {
            pauseAnimation();
            startAnimation();
        }
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫
    startButton.addEventListener('click', startAnimation);
    pauseButton.addEventListener('click', pauseAnimation);
    resetButton.addEventListener('click', resetAnimation);
    exportButton.addEventListener('click', exportChart);

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–∞
    initChart();
    
    console.log('Chart initialized successfully');
});

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
window.addEventListener('error', function(e) {
    console.error('Error:', e.error);
});
</script>

<!-- MathJax –¥–ª—è —Ñ–æ—Ä–º—É–ª -->
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
{% endblock %}